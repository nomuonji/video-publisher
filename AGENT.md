# Vercel開発環境の注意点

このプロジェクトを `vercel dev` を使ってローカル開発する際には、特有の非互換性問題が発生するため、以下の点に注意してください。

## 症状

`vercel dev` 環境で、`/api` で始まるサーバーレス関数へのリクエストが、APIとして実行されず、フロントエンドのVite開発サーバーにプロキシされてしまう問題が頻繁に発生します。

これにより、APIを呼び出しても502エラーや、意図せずフロントエンドのトップページが表示される、といった不可解な挙動が起きます。

## 原因

Vercelがプロジェクトを「Viteプロジェクト」として自動認識することによる特殊なルーティング設定と、ローカルのWindows環境、あるいは `vercel.json` の手動設定との間に、深刻な互換性の問題がある可能性が極めて高いです。

`console.log` やグローバル例外ハンドラすら実行されないことから、Node.jsのコードが一行も実行される前にルーティングが失敗していると結論付けられます。

## 推奨される開発ワークフロー

1.  **ローカルでのAPIテストを信頼しない:** `vercel dev` でのAPIの動作確認は、この問題のため信頼性が低いです。
2.  **デプロイによる実環境テストを優先:** APIのロジックを変更した際は、ローカルでのビルド (`npm run build`) が通ることを確認したら、**すぐにVercelにデプロイ（`git push`）し、デプロイされたプレビュー環境や本番環境のURLで動作確認を行うこと**を強く推奨します。
3.  **問題の切り分け:** もし再度同様のルーティング問題が発生した場合、Vercelのプロジェクト設定 → "General" → "Framework Preset" を "Vite" から "Other" に変更することで、問題がVercelの自動設定に起因するかを切り分けることができます。（ただし、副作用として他のルーティングに影響が出る可能性があります）
